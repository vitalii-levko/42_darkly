#!/bin/bash

URL="http://10.12.1.129/.hidden/"
TOTAL=0
START="$(date +%s)"

function search {
	LINKS=$(curl -s $1 | grep "<a href=" | cut -d'"' -f2 | sort -r)
	for link in $LINKS; do
		if [ $link == "../" ]; then
			continue
		elif [ $link == "README" ]; then
			let TOTAL=TOTAL+1
			README=$(curl -s "${1}${link}")
			if [[ $README =~ ^[0-9a-f]+$ ]]; then
				echo "THE FLAG IS ${README}"
				echo "FOUND IN ${1}"
				echo "README SEARCHED ${TOTAL}"
				END=$(date +%s)
				ELAPSED=$(($END - $START))
				echo "TIME ELAPSED $(($ELAPSED / 60)) MIN $(($ELAPSED % 60)) SEC"
				exit 0
			fi
		else
			search "${1}${link}"
		fi
	done
}

search $URL
echo "NOT FOUND"
